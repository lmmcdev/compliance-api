import { MigrationInterface, QueryRunner } from "typeorm";

export class Migration1755549641208 implements MigrationInterface {
    name = 'Migration1755549641208'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`CREATE TABLE "location_types" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_a8e0edf03ea5715ed995151d637" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_341188fd21c1c58cdd1c930aab4" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_76d74e985f4995022c8058d8e4d" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "code" nvarchar(128) NOT NULL, "display_name" nvarchar(128) NOT NULL, "description" nvarchar(256), CONSTRAINT "PK_a8e0edf03ea5715ed995151d637" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE TABLE "healthcare_providers" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_b9d01ce3cd5ba4e1e1f8f57d998" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_c22467a3b9c86be1479ac25aa3c" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_ecf7c17009340ad169a0e75ec8c" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "healthcare_provider_name" nvarchar(256) NOT NULL, "provider_type" nvarchar(128), "provider_subtype" nvarchar(128), "provider_class" nvarchar(128), "status" nvarchar(64), "mdvita_healthcare_id" nvarchar(64), "npi" nvarchar(64), "practitioner" nvarchar(256), "autonomous_aprn" bit NOT NULL CONSTRAINT "DF_273c743107f8aa7eb6efba87da2" DEFAULT 0, "days_off" nvarchar(256), "in_house" bit NOT NULL CONSTRAINT "DF_c9cd5486a6915abd6907ece444e" DEFAULT 0, "provider_id" nvarchar(128), "pcp" bit NOT NULL CONSTRAINT "DF_562da1385f3f893fefd9981c0f7" DEFAULT 0, "attending_physician" bit NOT NULL CONSTRAINT "DF_89b63f5eb028e002f2ac8393dc9" DEFAULT 0, "effective_from" datetime2, "effective_to" datetime2, "termination_date" datetime2, "total_licensed_beds" int, "use_cms_ma_contract_amendment" bit NOT NULL CONSTRAINT "DF_ec2072fda1f0fdb9a7cfd75fe8a" DEFAULT 0, "account_id" uniqueidentifier NOT NULL, "facility_id" uniqueidentifier, "facility_ii_id" uniqueidentifier, "facility_iii_id" uniqueidentifier, CONSTRAINT "PK_b9d01ce3cd5ba4e1e1f8f57d998" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE TABLE "locations" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_7cc1c9e3853b94816c094825e74" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_6078d870207b8386e700dfb0345" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_ff339711522e18cb1540aa30e7f" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "name" nvarchar(128) NOT NULL, "description" nvarchar(256), "external_reference" nvarchar(64), "time_zone" nvarchar(64) CONSTRAINT "DF_8034181b1331adf344a622c7042" DEFAULT 'America/New_York', "driving_directions" nvarchar(1024), "latitude" decimal(9,6), "longitude" decimal(9,6), "location_type_id" uniqueidentifier NOT NULL, "address_id" uniqueidentifier, "visitor_address_id" uniqueidentifier, "parent_location_id" uniqueidentifier, CONSTRAINT "PK_7cc1c9e3853b94816c094825e74" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IX_Locations_Name" ON "locations" ("name") `);
        await queryRunner.query(`CREATE TABLE "addresses" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_745d8f43d3af10ab8247465e450" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_8813e791fe4c6cc9de77c950c70" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_f695ee88c4fefac775eb871aea2" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "street" nvarchar(128) NOT NULL, "city" nvarchar(128) NOT NULL, "state" nvarchar(128) NOT NULL CONSTRAINT "DF_dec4ebd2fa2ab82db7228e08189" DEFAULT 'FL', "zip" nvarchar(10) NOT NULL, "country" nvarchar(128) NOT NULL CONSTRAINT "DF_35936c20d74117b96ca37c06dbf" DEFAULT 'United States', "address_type" nvarchar(20) NOT NULL, "driving_direction" nvarchar(256), "description" nvarchar(256), "timeZone" nvarchar(256), "lead" nvarchar(20), "location_type_id" uniqueidentifier NOT NULL, CONSTRAINT "PK_745d8f43d3af10ab8247465e450" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IX_addresses_location_type_id" ON "addresses" ("location_type_id") `);
        await queryRunner.query(`CREATE TABLE "accounts" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_5a7a02c20412299d198e097a8fe" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_359eb8520e0cc17e8600456f7d5" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_2aa2fcea3177123a1a9413be65c" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "name" nvarchar(256) NOT NULL, "account_number" nvarchar(64) NOT NULL, "type" nvarchar(64), "phone" nvarchar(64), "last_call_date" datetime2, "termination_date_in_mdvita" datetime2, "mdvita_disenrollment" bit NOT NULL CONSTRAINT "DF_728c6428f87af38d2be976760cd" DEFAULT 0, "patient_dx" nvarchar(256), "diagnoses2" nvarchar(256), "center_manager_email_2" nvarchar(256), "health_plan_insurance" nvarchar(256), "payer" nvarchar(256), "in_house" bit NOT NULL CONSTRAINT "DF_2dc168fbd78da9f41e91deea898" DEFAULT 0, "fax" nvarchar(64), "member_number" nvarchar(128), "plan" nvarchar(256), "plan_type" nvarchar(128), "number_hospitalizations" int, "physical_evaluation_last_year" bit, "billing_address_id" uniqueidentifier, CONSTRAINT "PK_5a7a02c20412299d198e097a8fe" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE UNIQUE INDEX "IX_accounts_account_number" ON "accounts" ("account_number") `);
        await queryRunner.query(`CREATE TABLE "healthcare_facilities" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_55280a0af085cf34a9df50543e7" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_9f1bfd8f22b265e9865422430b9" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_104222c2463c171b1899cee4f49" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "name" nvarchar(256) NOT NULL, "location" nvarchar(256), "location_type" nvarchar(128), "licensed_bed_count" int, "facility_type" nvarchar(128), "availability_exceptions" nvarchar(512), "always_open" bit NOT NULL CONSTRAINT "DF_a156246abff810e44fc3595832a" DEFAULT 0, "source_system" nvarchar(128), "source_system_id" nvarchar(128), "source_system_modified" datetime2, "account_id" uniqueidentifier NOT NULL, "address_id" uniqueidentifier, CONSTRAINT "PK_55280a0af085cf34a9df50543e7" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE TABLE "business_licenses" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_f47264eccd6d6af45472eaa152c" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_59dc18546c32e233f60f5c657b9" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_9f589a464920c3a16e12cbe78df" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "name" nvarchar(256) NOT NULL, "issue_date" datetime2, "renewal_date" datetime2, "termination_date" datetime2, "license_number" nvarchar(128), "certificate_number" nvarchar(128), "status" nvarchar(64), "is_active" bit NOT NULL CONSTRAINT "DF_c9b9ca69c2797aff12cc6f3cdec" DEFAULT 0, "description" nvarchar(1024), "license_type_id" uniqueidentifier, "healthcare_facility_id" uniqueidentifier, "healthcare_provider_id" uniqueidentifier, "account_id" uniqueidentifier, CONSTRAINT "PK_f47264eccd6d6af45472eaa152c" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IX_business_licenses_license_number" ON "business_licenses" ("license_number") `);
        await queryRunner.query(`CREATE TABLE "license_types" ("id" uniqueidentifier NOT NULL CONSTRAINT "DF_08e56128297e619b3acdbac942b" DEFAULT NEWSEQUENTIALID(), "created_at" datetime2 NOT NULL CONSTRAINT "DF_6a0dc5f3fad4db3f4d6c2540a92" DEFAULT GETUTCDATE(), "updated_at" datetime2 NOT NULL CONSTRAINT "DF_6b2f5cd9a6a1215cc34f73ce923" DEFAULT GETUTCDATE(), "deleted_at" datetime2, "code" nvarchar(64) NOT NULL, "display_name" nvarchar(256), "description" nvarchar(512), CONSTRAINT "PK_08e56128297e619b3acdbac942b" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE UNIQUE INDEX "UQ_license_types_code" ON "license_types" ("code") `);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" ADD CONSTRAINT "FK_920079748f47ade24fc8addd5f4" FOREIGN KEY ("account_id") REFERENCES "accounts"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" ADD CONSTRAINT "FK_1460147d67e8b7893be0d5efedf" FOREIGN KEY ("facility_id") REFERENCES "healthcare_facilities"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" ADD CONSTRAINT "FK_6e28525fb3d8def0ef26bd577fe" FOREIGN KEY ("facility_ii_id") REFERENCES "healthcare_facilities"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" ADD CONSTRAINT "FK_4a8092605379ea302093b831ffc" FOREIGN KEY ("facility_iii_id") REFERENCES "healthcare_facilities"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "FK_7946d88c254fb0b001ad02676a9" FOREIGN KEY ("location_type_id") REFERENCES "location_types"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "FK_01115a9e4b379d84f976c082117" FOREIGN KEY ("address_id") REFERENCES "addresses"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "FK_a3fc8a028184701b544ad25ef5d" FOREIGN KEY ("visitor_address_id") REFERENCES "addresses"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "FK_06f770dfdf4e78f67ad08f80cdc" FOREIGN KEY ("parent_location_id") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "addresses" ADD CONSTRAINT "FK_93c5c6140ade77525e4bde33091" FOREIGN KEY ("location_type_id") REFERENCES "location_types"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "accounts" ADD CONSTRAINT "FK_2eef67ac44665c0dd16a6eef269" FOREIGN KEY ("billing_address_id") REFERENCES "addresses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "healthcare_facilities" ADD CONSTRAINT "FK_ca2f8f19a3deb53d3dcc0315f7a" FOREIGN KEY ("account_id") REFERENCES "accounts"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "healthcare_facilities" ADD CONSTRAINT "FK_9d49b77fd58e761772679206a08" FOREIGN KEY ("address_id") REFERENCES "addresses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "business_licenses" ADD CONSTRAINT "FK_65acd6eae7c4e71c8fd4ace8cb8" FOREIGN KEY ("license_type_id") REFERENCES "license_types"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "business_licenses" ADD CONSTRAINT "FK_2349edde6cc34ad96ad44132d6c" FOREIGN KEY ("healthcare_facility_id") REFERENCES "healthcare_facilities"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "business_licenses" ADD CONSTRAINT "FK_b4f7852e452bd27e1acb5d577e0" FOREIGN KEY ("healthcare_provider_id") REFERENCES "healthcare_providers"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "business_licenses" ADD CONSTRAINT "FK_8dfb21971d31cad1c094cb0f93f" FOREIGN KEY ("account_id") REFERENCES "accounts"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "business_licenses" DROP CONSTRAINT "FK_8dfb21971d31cad1c094cb0f93f"`);
        await queryRunner.query(`ALTER TABLE "business_licenses" DROP CONSTRAINT "FK_b4f7852e452bd27e1acb5d577e0"`);
        await queryRunner.query(`ALTER TABLE "business_licenses" DROP CONSTRAINT "FK_2349edde6cc34ad96ad44132d6c"`);
        await queryRunner.query(`ALTER TABLE "business_licenses" DROP CONSTRAINT "FK_65acd6eae7c4e71c8fd4ace8cb8"`);
        await queryRunner.query(`ALTER TABLE "healthcare_facilities" DROP CONSTRAINT "FK_9d49b77fd58e761772679206a08"`);
        await queryRunner.query(`ALTER TABLE "healthcare_facilities" DROP CONSTRAINT "FK_ca2f8f19a3deb53d3dcc0315f7a"`);
        await queryRunner.query(`ALTER TABLE "accounts" DROP CONSTRAINT "FK_2eef67ac44665c0dd16a6eef269"`);
        await queryRunner.query(`ALTER TABLE "addresses" DROP CONSTRAINT "FK_93c5c6140ade77525e4bde33091"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "FK_06f770dfdf4e78f67ad08f80cdc"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "FK_a3fc8a028184701b544ad25ef5d"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "FK_01115a9e4b379d84f976c082117"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "FK_7946d88c254fb0b001ad02676a9"`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" DROP CONSTRAINT "FK_4a8092605379ea302093b831ffc"`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" DROP CONSTRAINT "FK_6e28525fb3d8def0ef26bd577fe"`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" DROP CONSTRAINT "FK_1460147d67e8b7893be0d5efedf"`);
        await queryRunner.query(`ALTER TABLE "healthcare_providers" DROP CONSTRAINT "FK_920079748f47ade24fc8addd5f4"`);
        await queryRunner.query(`DROP INDEX "UQ_license_types_code" ON "license_types"`);
        await queryRunner.query(`DROP TABLE "license_types"`);
        await queryRunner.query(`DROP INDEX "IX_business_licenses_license_number" ON "business_licenses"`);
        await queryRunner.query(`DROP TABLE "business_licenses"`);
        await queryRunner.query(`DROP TABLE "healthcare_facilities"`);
        await queryRunner.query(`DROP INDEX "IX_accounts_account_number" ON "accounts"`);
        await queryRunner.query(`DROP TABLE "accounts"`);
        await queryRunner.query(`DROP INDEX "IX_addresses_location_type_id" ON "addresses"`);
        await queryRunner.query(`DROP TABLE "addresses"`);
        await queryRunner.query(`DROP INDEX "IX_Locations_Name" ON "locations"`);
        await queryRunner.query(`DROP TABLE "locations"`);
        await queryRunner.query(`DROP TABLE "healthcare_providers"`);
        await queryRunner.query(`DROP TABLE "location_types"`);
    }

}
